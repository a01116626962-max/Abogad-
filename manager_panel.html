<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>
    <style>
        /* Ø§Ù„Ø£Ù†Ù…Ø§Ø· (CSS) */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: right;
            direction: rtl;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #007bff;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 20px;
        }
        .action-buttons {
            margin-bottom: 20px;
        }
        button {
            padding: 10px 15px;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            transition: background-color 0.3s;
            background-color: #007bff; /* Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« */
        }
        button:hover {
            opacity: 0.9;
        }
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£ÙŠØ§Ù… */
        .day-buttons button {
            background-color: #6c757d;
            margin: 5px;
            font-weight: bold;
        }
        .day-buttons button.active {
            background-color: #28a745; /* Ø£Ø®Ø¶Ø± Ù„Ù„Ø¯Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø®ØªØ§Ø± */
        }
        /* Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø£ÙŠØ§Ù… */
        .day-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .day-table th, .day-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: right;
        }
        .day-table th {
            background-color: #f2f2f2;
            color: #333;
        }
        .status-absent {
            color: #dc3545; 
            font-weight: bold;
        }
        .status-present {
            color: #28a745; 
            font-weight: bold;
        }
        .status-default-muted {
            color: #999; 
            font-style: italic;
        }
        /* Ø§Ù„Ø²Ø± Ø§Ù„Ø«Ø§Ø¨Øª */
        #static-whatsapp-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background-color: #075E54; 
            font-size: 1.1em;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
</head>
<body>

<div class="container">
    <h1>ğŸ—“ï¸ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>
    
    <div id="result-area" style="margin-top:15px; padding:10px; border:1px solid #eee;">
        <p style="color:#007bff;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„" Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.</p>
    </div>

    <div class="action-buttons">
        <button onclick="fetchAttendanceData()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <hr>

    <h2>ğŸ—“ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¶ÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… (Ù„Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø£Ùˆ Ø§Ù„Ù…Ø¹ØªØ°Ø±ÙŠÙ†)</h2>

    <div class="day-buttons">
        <button id="btn-Ø§Ù„Ø³Ø¨Øª" onclick="viewDay('Ø§Ù„Ø³Ø¨Øª')">Ø§Ù„Ø³Ø¨Øª</button>
        <button id="btn-Ø§Ù„Ø£Ø­Ø¯" onclick="viewDay('Ø§Ù„Ø£Ø­Ø¯')">Ø§Ù„Ø£Ø­Ø¯</button>
        <button id="btn-Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†" onclick="viewDay('Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†')">Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</button>
        <button id="btn-Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡" onclick="viewDay('Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡')">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</button>
        <button id="btn-Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡" onclick="viewDay('Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡')">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</button>
        <button id="btn-Ø§Ù„Ø®Ù…ÙŠØ³" onclick="viewDay('Ø§Ù„Ø®Ù…ÙŠØ³')">Ø§Ù„Ø®Ù…ÙŠØ³</button>
    </div>

    <div id="day-details">
        <p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ù„Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ†.</p>
    </div>
    
    <button id="static-whatsapp-button" onclick="sendAttendanceListViaWhatsApp()" disabled>
        ğŸ“² ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ±
    </button>
</div>

<script>
    // âš ï¸ Ù…ÙØ§ØªÙŠØ­ Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¹Ø§Ù…Ù„ (rdtt-15cbe) - Ù†ÙØ³ Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    const firebaseConfig = {
        apiKey: "AIzaSyCDJANXMfd6TR7R2ruLIi-xytlrB-LiCEs",
        authDomain: "rdtt-15cbe.firebaseapp.com",
        projectId: "rdtt-15cbe",
        storageBucket: "rdtt-15cbe.firebasestorage.app",
        messagingSenderId: "219502671343",
        appId: "1:219502671343:web:b289b11869e25c9a30321a"
    };

    // ØªÙ‡ÙŠØ¦Ø© Firebase ÙˆØ§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Firestore
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    
    // ----------------------------------------------------------------
    // 1. Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© ÙˆØ§Ù„Ù…Ø¬Ø¯ÙˆÙ„Ø© (ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£ØµÙ„ÙŠ)
    // ----------------------------------------------------------------
    // Ù„Ù… Ù†Ø¹Ø¯ Ù†Ø³ØªØ®Ø¯Ù… Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±Ù Ù„Ø£Ù†Ù‡ Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø¬Ù‡Ø© ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§
    const WORKING_DAYS = ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³"];
    const ALL_WORKING_DAYS = WORKING_DAYS; 

    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ† Ø§Ù„Ø«Ø§Ø¨Øª
    const FIXED_VOLUNTEERS = {
        // Ø§Ù„ØªØ±ØªÙŠØ¨:
        "Ø£Ø­Ù…Ø¯": ALL_WORKING_DAYS.filter(day => day !== "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡" && day !== "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"),
        "Ù‡Ø¯ÙŠØ±": ALL_WORKING_DAYS,
        "Ù…Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…": ALL_WORKING_DAYS,
        "Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø­Ù…ÙŠØ¯": ALL_WORKING_DAYS.filter(day => day !== "Ø§Ù„Ø£Ø­Ø¯"),
        "Ø³Ø§Ù…Ù‰": ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"], // âœ… Ø§Ù„Ø§Ø³Ù… Ù…ÙØ¹Ø¯Ù‘Ù„ Ø§Ù„Ø¢Ù†
        "Ù…Ù…ØªØ§Ø²": ALL_WORKING_DAYS,
        "Ø­Ø¨ÙŠØ¨Ø©": ALL_WORKING_DAYS,
        "Ø³Ø§Ù†Ø¯ÙŠ": ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"],
        "Ø±Ø­Ø§Ø¨": ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"],
        "Ù…Ø¹Ø§Ø°": ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³"],
        "ÙŠÙˆØ³Ù": ALL_WORKING_DAYS.filter(day => day !== "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡" && day !== "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"),
        "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…": ALL_WORKING_DAYS,
        "Ù…Ø±ÙˆØ§Ù†": ALL_WORKING_DAYS,
        "Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†": ALL_WORKING_DAYS.filter(day => day !== "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†" && day !== "Ø§Ù„Ø®Ù…ÙŠØ³")
    };
    
    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ† Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø£Ø¹Ù„Ø§Ù‡
    const VOLUNTEER_NAMES_ORDERED = Object.keys(FIXED_VOLUNTEERS);
    
    let currentAttendanceData = {}; 
    let selectedDay = null;
    let currentAttendanceList = [];

    // ----------------------------------------------------------------
    // 2. ÙˆØ¸ÙŠÙØ© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
    // ----------------------------------------------------------------
    async function fetchAttendanceData() {
        const resultArea = document.getElementById('result-area');
        resultArea.style.display = 'block';
        resultArea.innerHTML = '<p style="color:#007bff;">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase...</p>';

        currentAttendanceData = {}; 

        try {
            // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© user_attendance
            const snapshot = await db.collection("user_attendance").get();

            snapshot.forEach(doc => {
                const data = doc.data();
                const name = data.volunteerName;
                const day = data.day;

                if (!currentAttendanceData[name]) {
                    currentAttendanceData[name] = {};
                }
                
                // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ø³Ø¨Ø¨ ÙˆÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                currentAttendanceData[name][day] = { 
                    status: data.status, 
                    reason: data.reason,
                    registrationTime: data.registrationTime 
                };
            });

            resultArea.innerHTML = `<p class="status-present">âœ… **ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­.** (ØªÙ… Ø¬Ù„Ø¨ ${snapshot.docs.length} Ø³Ø¬Ù„)</p>`;
            
            if(selectedDay) {
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø®ØªØ§Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«
                viewDay(selectedDay); 
            }

        } catch (error) {
            resultArea.innerHTML = `<p class="status-absent">âŒ **Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** ${error.message}</p>`;
            console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ", error);
        }
    }

    // ----------------------------------------------------------------
    // 3. ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ… (Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase)
    // ----------------------------------------------------------------
    function viewDay(day) {
        const dayDetailsDiv = document.getElementById('day-details');
        
        document.querySelectorAll('.day-buttons button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`btn-${day}`).classList.add('active');
        
        selectedDay = day;

        let tableHTML = `
            <h3>Ø¬Ø¯ÙˆÙ„ ÙŠÙˆÙ… ${day}</h3>
            <table class="day-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª / Ø§Ù„Ø³Ø¨Ø¨</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        let finalAttendanceList = []; 
        
        VOLUNTEER_NAMES_ORDERED.forEach(name => {
            const isFixed = FIXED_VOLUNTEERS[name].includes(day);
            const recordedStatus = currentAttendanceData[name] && currentAttendanceData[name][day];

            let displayStatus;
            let statusClass;
            let reason = '';
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
            if (recordedStatus) {
                reason = recordedStatus.status === 'Ø§Ø¹ØªØ°Ø§Ø±' ? recordedStatus.reason : '';
                const timeDisplay = recordedStatus.registrationTime ? ` (Ø³ÙØ¬Ù‘Ù„: ${recordedStatus.registrationTime.split(' â€“ ')[1]})` : '';

                if (recordedStatus.status === 'Ø§Ø¹ØªØ°Ø§Ø±') {
                    displayStatus = `âŒ Ø§Ø¹ØªØ°Ø§Ø± Ø·Ø§Ø±Ø¦${timeDisplay}`;
                    statusClass = 'status-absent';
                } else { 
                    displayStatus = `âœ… Ø­Ø¶ÙˆØ± Ù…Ø¤ÙƒØ¯ (ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„)${timeDisplay}`;
                    statusClass = 'status-present';
                }
            } else {
                if (isFixed) {
                    displayStatus = 'âœ… Ø­Ø¶ÙˆØ± Ù…Ø¤ÙƒØ¯ (Ø¬Ø¯ÙˆÙ„ Ø«Ø§Ø¨Øª)'; 
                    statusClass = 'status-present'; 
                } else {
                    displayStatus = '--- ØºÙŠØ± Ù…Ø¬Ø¯ÙˆÙ„';
                    statusClass = 'status-default-muted'; 
                }
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø­Ø§Ø¶Ø± ÙØ¹Ù„ÙŠØ§Ù‹
            const isAttending = (isFixed || (recordedStatus && recordedStatus.status === 'Ø­Ø¶ÙˆØ±')) && 
                                (!recordedStatus || recordedStatus.status !== 'Ø§Ø¹ØªØ°Ø§Ø±');

            if (isAttending) {
                finalAttendanceList.push(name);
            }

            tableHTML += `
                <tr>
                    <td>${name}</td>
                    <td class="${statusClass}">${displayStatus}</td>
                    <td>${reason || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</td>
                </tr>
            `;
        });


        tableHTML += `</tbody></table>`;
        
        dayDetailsDiv.innerHTML = tableHTML;
        
        currentAttendanceList = finalAttendanceList;
        updateStaticWhatsAppButton(day, finalAttendanceList);
    }
    
    // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø§Ù„Ø«Ø§Ø¨Øª
    function updateStaticWhatsAppButton(day, list) {
        const staticButton = document.getElementById('static-whatsapp-button');
        if (day && list) {
            staticButton.disabled = false;
            staticButton.textContent = `ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ù„ÙŠÙˆÙ… ${day} Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ (${list.length} Ù…ØªØ·ÙˆØ¹)`;
            staticButton.style.backgroundColor = '#075E54';
        } else {
             staticButton.disabled = true;
             staticButton.textContent = 'ğŸ“² ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ±';
             staticButton.style.backgroundColor = '#6c757d';
        }
    }


    // ----------------------------------------------------------------
    // 4. ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ 
    // ----------------------------------------------------------------
    function sendAttendanceListViaWhatsApp() {
        if (!selectedDay) return;

        const day = selectedDay;
        const attendanceList = currentAttendanceList;
        
        const now = new Date();
        // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ: 21 Ù†ÙˆÙÙ…Ø¨Ø± 2025
        const dateString = now.toLocaleDateString('ar-EG', { day: 'numeric', month: 'long', year: 'numeric' });
        
        let listText = attendanceList.map((name, index) => `${index + 1}. ${name}`).join('\n');
        
        if (attendanceList.length === 0) {
            listText = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¶ÙˆØ± Ù…Ø¤ÙƒØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….";
        }
        
        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¨Ø¯ÙˆÙ† Ù†Ø¬ÙˆÙ…
        const message = `
ğŸ“Œ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
ğŸ—“ï¸ Ø§Ù„ÙŠÙˆÙ… : ${day} - ${dateString}
ğŸ‘¥ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¤ÙƒØ¯ : ${attendanceList.length} Ù…ØªØ·ÙˆØ¹

---
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ† Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„ÙŠÙˆÙ…:
${listText}
`;
        
        const encodedMessage = encodeURIComponent(message.trim());
        
        // ğŸŒŸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø§Ø³ØªØ®Ø¯Ø§Ù… wa.me/?text= Ù„ÙØªØ­ Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„/Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ğŸŒŸ
        const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
        
        const sendButton = document.getElementById('static-whatsapp-button');
        sendButton.textContent = 'âœ… Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨...';
        
        window.open(whatsappUrl, '_blank');
        
        setTimeout(() => {
             sendButton.textContent = `ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ù„ÙŠÙˆÙ… ${day} Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ (${attendanceList.length} Ù…ØªØ·ÙˆØ¹)`;
        }, 5000);
    }
    
    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹
    window.onload = fetchAttendanceData;
</script>

</body>
</html>
